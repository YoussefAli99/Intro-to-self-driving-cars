<!-- udacimak v1.6.6 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Representing State with Matrices</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Matrices and Transformation of State</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Connection to Kalman Filters.html">01. Connection to Kalman Filters</a>
    </li>
    <li class="">
      <a href="02. Kalman Prediction.html">02. Kalman Prediction</a>
    </li>
    <li class="">
      <a href="03. Kalman Filter Land.html">03. Kalman Filter Land</a>
    </li>
    <li class="">
      <a href="04. Kalman Filter Prediction.html">04. Kalman Filter Prediction</a>
    </li>
    <li class="">
      <a href="05. Another Prediction.html">05. Another Prediction</a>
    </li>
    <li class="">
      <a href="06. More Kalman Filters.html">06. More Kalman Filters</a>
    </li>
    <li class="">
      <a href="07. A Note on Notation.html">07. A Note on Notation</a>
    </li>
    <li class="">
      <a href="08. Kalman Filter Design.html">08. Kalman Filter Design</a>
    </li>
    <li class="">
      <a href="09. Let&#x27;s Look at Where we Are.html">09. Let&#x27;s Look at Where we Are</a>
    </li>
    <li class="">
      <a href="10. The Kalman Filter Equations.html">10. The Kalman Filter Equations</a>
    </li>
    <li class="">
      <a href="11. Simplifying the Kalman Filter Equations.html">11. Simplifying the Kalman Filter Equations</a>
    </li>
    <li class="">
      <a href="12. The Rest of the Lesson.html">12. The Rest of the Lesson</a>
    </li>
    <li class="">
      <a href="13. Representing State with Matrices.html">13. Representing State with Matrices</a>
    </li>
    <li class="">
      <a href="14. Kalman Equation Reference.html">14. Kalman Equation Reference</a>
    </li>
    <li class="">
      <a href="15. What is a vector.html">15. What is a vector?</a>
    </li>
    <li class="">
      <a href="16. Vectors in Python.html">16. Vectors in Python</a>
    </li>
    <li class="">
      <a href="17. Coding Vectors.html">17. Coding Vectors</a>
    </li>
    <li class="">
      <a href="18. Coding Vectors (solution).html">18. Coding Vectors (solution)</a>
    </li>
    <li class="">
      <a href="19. Guide to Mathematical Notation.html">19. Guide to Mathematical Notation</a>
    </li>
    <li class="">
      <a href="20. Matrices in Python.html">20. Matrices in Python</a>
    </li>
    <li class="">
      <a href="21. Coding Matrices.html">21. Coding Matrices</a>
    </li>
    <li class="">
      <a href="22. Coding Matrices (Solution).html">22. Coding Matrices (Solution)</a>
    </li>
    <li class="">
      <a href="23. Matrix Addition.html">23. Matrix Addition</a>
    </li>
    <li class="">
      <a href="24. Coding Matrix Addition.html">24. Coding Matrix Addition</a>
    </li>
    <li class="">
      <a href="25. Coding Matrix Addition (Solution).html">25. Coding Matrix Addition (Solution)</a>
    </li>
    <li class="">
      <a href="26. Matrix Multiplication.html">26. Matrix Multiplication</a>
    </li>
    <li class="">
      <a href="27. Coding Matrix Multiplication.html">27. Coding Matrix Multiplication</a>
    </li>
    <li class="">
      <a href="28. Coding Matrix Multiplication (Solution).html">28. Coding Matrix Multiplication (Solution)</a>
    </li>
    <li class="">
      <a href="29. Transpose of a Matrix.html">29. Transpose of a Matrix</a>
    </li>
    <li class="">
      <a href="30. Coding the Transpose.html">30. Coding the Transpose</a>
    </li>
    <li class="">
      <a href="31. Coding the Transpose (Solution).html">31. Coding the Transpose (Solution)</a>
    </li>
    <li class="">
      <a href="32. The Identity Matrix.html">32. The Identity Matrix</a>
    </li>
    <li class="">
      <a href="33. Coding Identity Matrix.html">33. Coding Identity Matrix</a>
    </li>
    <li class="">
      <a href="34. Coding Identity Matrix (Solution).html">34. Coding Identity Matrix (Solution)</a>
    </li>
    <li class="">
      <a href="35. Matrix Inverse.html">35. Matrix Inverse</a>
    </li>
    <li class="">
      <a href="36. Coding Matrix Inverse.html">36. Coding Matrix Inverse</a>
    </li>
    <li class="">
      <a href="37. Coding Matrix Inverse (Solution).html">37. Coding Matrix Inverse (Solution)</a>
    </li>
    <li class="">
      <a href="38. What to Take Away from this Lesson.html">38. What to Take Away from this Lesson</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">13. Representing State with Matrices</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3></h3>
  <div>
  <h1 id="representing-state-with-matrices">Representing State with Matrices</h1>
<h3 id="the-state-vector">The State Vector</h3>
<p>You just learned how to represent a self-driving car's state using a motion model. It turns out that matrices provide a very convenient and compact form for representing a vehicle's state. </p>
<p>Let's go back to the constant velocity motion model: </p>
<p><span class="mathquill ud-math">distance = velocity \times time</span></p>
<p>The vehicle's state is represented by the two variables distance and velocity. If you were going to store these two variables in Python, you'd probably use a list like this:</p>
<pre><code class="python language-python">state = [distance, velocity]</code></pre>
<p>That Python code looks a lot like a mathematical concept called a vector. A vector is essentially a list where each element in the list contains some information. </p>
<p>You could imagine that a state vector could have even more information. In a two-dimensional world, the state could have a <span class="mathquill ud-math">distance_x</span>, <span class="mathquill ud-math">distance_y</span>, <span class="mathquill ud-math">velocity_x</span> and a <span class="mathquill ud-math">velocity_y</span>.</p>
<p>In Python, the list would look like this:</p>
<pre><code class="python language-python">state = [distance_x, distance_y, velocity_x, velocity_y]</code></pre>
<p>Or an even more complex model could include information about the turning angle of the vehicle and the turning rate:</p>
<pre><code class="python language-python">state = [distance_x, distance_y, velocity_x, velocity_y, angle, angle_rate]</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="state-vector-in-a-one-dimensional-world">State Vector in a One-Dimensional World</h3>
<p>For now, consider the one-dimensional model with just distance and velocity.</p>
<pre><code class="python language-python">state = [distance, velocity]</code></pre>
<p>How did you calculate the distance and velocity of the vehicle over time when the velocity was constant? There were two different equations. </p>
<p><span class="mathquill ud-math">\begin{cases}distance = velocity \times time \\velocity = velocity\end{cases}</span></p>
<p>Now, think about these equations in terms of state. For convenience, you can represent distance as <span class="mathquill ud-math">x</span>, velocity as <span class="mathquill ud-math">v</span>, and time as <span class="mathquill ud-math">t</span>. </p>
<h5 id="initial-state">Initial State</h5>
<p>When the vehicle first starts moving, you can consider that <span class="mathquill ud-math">t = t_0</span>, <span class="mathquill ud-math">x = x_0</span> and <span class="mathquill ud-math">v = v_0</span>. So the state vector is <span class="mathquill ud-math">state_0 = [x_0, v_0]</span>.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h5 id="first-time-step">First Time Step</h5>
<p>What about after a certain amount of time has passed and now you are at a time <span class="mathquill ud-math">t_1</span>?  </p>
<p>At <span class="mathquill ud-math">t_1</span>, the state vector is:</p>
<p><span class="mathquill ud-math">state_1 = [x_1, v_1] </span></p>
<p>According to the model formulas, </p>
<p><span class="mathquill ud-math">x_1 = x_0 + v_0 \times (t_1 - t_0)</span></p>
<p>and since velocity is constant:</p>
<p><span class="mathquill ud-math">v_1 = v_0</span>.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h5 id="second-time-step">Second Time Step</h5>
<p>Then after the next time step <span class="mathquill ud-math">t_2</span>, the state vector is:<br />
<span class="mathquill ud-math">state_2 = [x_2, v_2]</span> </p>
<p>where</p>
<p><span class="mathquill ud-math">x_2 = x_1 + v_0 \times (t_2 - t_1)</span></p>
<p>and since velocity is constant <br />
<span class="mathquill ud-math">v_2 = v_0</span>.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="a-better-way">A Better Way</h3>
<p>The math so far is not too hard, right? You have a distance equation and a velocity equation. You plug in the previous state into each equation, the time lapse, and you get the new velocity and the new distance.</p>
<p>But imagine what will happen as your self-driving car model gets more complex. What happens when you have to take into account an x-direction, y-direction, x and y velocities, and steering angle and angular velocity? Or what about an even more complex model like a drone or helicopter that also has a z-direction?</p>
<p>Instead of updating your equations one by one, you can actually use vectors and matrices to do all of the calculations in just one step.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="updating-state-with-matrix-algebra">Updating State with Matrix Algebra</h3>
<p>If you look back at the equation that updates the distance, you'll notice that distance depends on the previous distance, the initial velocity, and how much time has elapsed since the distance formula was updated. You end up with a generic function:</p>
<p><span class="mathquill ud-math">x_{t+1} = x_{t} + v_0 \times (t_{t+1} - t_{t}) </span></p>
<p>You can also write <span class="mathquill ud-math">t_{t+1} - t_{t}</span> as:</p>
<p><span class="mathquill ud-math">\Delta t</span></p>
<p>For a constant velocity model, the generic velocity equation becomes:<br />
<span class="mathquill ud-math">v_{t+1} = v_{t}</span> </p>
<p>How could you combine the x and v equations into one matrix algebra expression? The matrix algebra would look like this:</p>
<p><span class="mathquill ud-math">\begin {bmatrix} x_{t+1} \\ v_{t+1} \end {bmatrix} =\begin {bmatrix} 1&  \Delta t \\0 & 1 \end{bmatrix}\times\begin {bmatrix} x_{t} \\ v_{t} \end{bmatrix}</span></p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Don't worry if you're not sure what this expression means or how to multiply these matrices. You will learn how in this lesson.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="notation">Notation</h3>
<p>The matrix algebra equation you just saw is actually one part of the Kalman filter update equation.</p>
<p>Traditionally, the matrix operation:</p>
<p><span class="mathquill ud-math">\begin {bmatrix} x_{t+1} \\ v_{t+1} \end {bmatrix} =\begin {bmatrix} 1&  \Delta t \\0 & 1 \end{bmatrix}\times\begin {bmatrix} x_{t} \\ v_{t} \end{bmatrix}</span></p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>is represented by this notation for Kalman filters:<br />
<span class="mathquill ud-math">\mathbf{\hat{x}<em>{k|k-1}} = \mathbf{F} \mathbf{\hat{x}</em>{k-1|k-1}}</span></p>
<p>where <br />
<span class="mathquill ud-math">\mathbf{\hat{x}}</span> is the state vector and <span class="mathquill ud-math">\mathbf{F}</span> is the matrix</p>
<p><span class="mathquill ud-math">\begin {bmatrix} 1&  \Delta t \\0 & 1 \end{bmatrix}</span></p>
<p><span class="mathquill ud-math">\mathbf{k - 1}</span> is the previous step and <span class="mathquill ud-math">\mathbf{k }</span> is the current step. </p>
<p>You will see in the next part of the lesson why the notation contains <span class="mathquill ud-math">\mathbf{k-1|k-1}</span> and <span class="mathquill ud-math">\mathbf{k|k-1}</span> .</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>This notation can get a little bit confusing. For example, what is the difference between <br />
<span class="mathquill ud-math">x</span> and <span class="mathquill ud-math">\mathbf{\hat{x}}</span>?</p>
<p>The regular <span class="mathquill ud-math">x</span> would usually represent distance along the x-axis; on the other hand, the bold <span class="mathquill ud-math">\mathbf{\hat{x}}</span> indicates a vector. In the one-dimensional case being discussed here, the <span class="mathquill ud-math">\mathbf{\hat{x}}</span> vector contains two variables: distance along the x-axis and velocity; hence<br />
<span class="mathquill ud-math">\bold{\hat{x}} = \begin{bmatrix} x \\ v \end{bmatrix}</span>.</p>
<p>Why is there a capitalized bold <span class="mathquill ud-math">\mathbf{F}</span> instead of <span class="mathquill ud-math">\mathbf{f}</span>? The capitalized, bold <span class="mathquill ud-math">\mathbf{F}</span> tells you that this variable is a matrix.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Match the variable with its type</p></h3>
  <div>
  <p><strong>QUIZ QUESTION:</strong>: <p>Match the variable with its type</p></p>
  <p><strong>ANSWER CHOICES:</strong></p>
  <button class="btn btn-primary"><p>vector</p></button>
  <button class="btn btn-primary"><p>scalar</p></button>
  <button class="btn btn-primary"><p>matrix</p></button>
  <button class="btn btn-primary"><p>matrix</p></button>
  <button class="btn btn-primary"><p>scalar</p></button>
  <button class="btn btn-primary"><p>vector</p></button>
  <button class="btn btn-primary"><p>scalar</p></button>

  <br><br>

  <table class="table">
    <tr class="thead-dark table-hover">
      <th>
        <p>Variable</p>
      </th>
      <th>
        <p>Type</p>
      </th>
    </tr>

    <tr>
      <td><p><strong>x</strong></p></td>
      <td></td>
    </tr>
    <tr>
      <td><p>x</p></td>
      <td></td>
    </tr>
    <tr>
      <td><p><strong>F</strong></p></td>
      <td></td>
    </tr>
    <tr>
      <td><p>p</p></td>
      <td></td>
    </tr>
    <tr>
      <td><p>y</p></td>
      <td></td>
    </tr>
    <tr>
      <td><p><strong>P</strong></p></td>
      <td></td>
    </tr>
    <tr>
      <td><p><strong>p</strong></p></td>
      <td></td>
    </tr>
  </table>

  <details>
    <summary><strong>SOLUTION:</strong></summary>

    <table class="table">
      <tr class="thead-dark table-hover">
        <th>
          <p>Variable</p>
        </th>
        <th>
          <p>Type</p>
        </th>
      </tr>

      <tr>
        <td>
          <p><strong>x</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>vector</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>p</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>vector</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>x</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>p</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>y</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>F</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>matrix</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>P</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>matrix</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>F</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>matrix</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>P</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>matrix</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>x</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>p</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>y</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>x</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>vector</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p><strong>p</strong></p>
        </td>
        <td>
            <button class="btn btn-primary"><p>vector</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>x</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>p</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
      <tr>
        <td>
          <p>y</p>
        </td>
        <td>
            <button class="btn btn-primary"><p>scalar</p></button>
        </td>
      </tr>
    </table>
  </details>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="14. Kalman Equation Reference.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://github.com/udacimak/udacimak#readme" target="_blank">udacimak v1.6.6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('13. Representing State with Matrices')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
